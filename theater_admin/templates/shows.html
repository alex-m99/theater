<!DOCTYPE html>
{% extends "index.html" %}
{% load static %}

{% block main_content %}

<div class="container-flex text-center justify-content-center align-items-center" style="padding-top: 10px; padding-bottom: 20px; margin-top: 10px;vertical-align: middle;">
    <div class="row justify-content-center align-middle" style="margin-top: 10px;height:60px;">
        <div class="col-md-4 text-light" style="background:#4B088A;">
            <h4 style="margin-top:15px">Adauga un spectacol</h4>
        </div>
        <div class="col-md-8">
            <h4>Cauta spectacole</h4>
        </div>
    </div>
    <div class="row">
        <div class="col-md-4">
            <div class="container" style="overflow-y:auto;height:595px;background: #CEECF5;">
                <form class="d-flex" action="/adauga-spectacole/add" method="POST">
                    {% csrf_token %}
                    <table class="table" style="margin-top: 20px;">
                         {% comment "" %}
                        <tr>
                            <td style="text-align: left;vertical-align: middle; padding-left: 15px;">Nume</td>
                            <td><input type="text" class="form-control" name="show_name"></td>
                        </tr>  
                        <tr>
                            <td style="text-align: left;vertical-align: middle; padding-left: 15px;">Autor</td>
                            <td><input type="text" class="form-control" name="show_author"></td>
                        </tr> 
                        {% endcomment %}
                        <tr>
                            <td style="text-align: left;vertical-align: middle; padding-left: 15px;">Piesa</td>
                            <td><select class="form-control" name="play_name">
                                {% for play in plays  %}
                                <option value="{{ play.Nume }}">{{play.Nume}}</option>
                                {% endfor %}
                                </select>
                           </td>
                        </tr> 
                        <tr>
                            <td style="text-align: left;vertical-align: middle; padding-left: 15px;">Regie</td>
                            <td><select class="form-control" name="director_name">
                                {% for employee in employees  %}
                                {% if employee.Functie == "Regizor" %}
                                <option value="{{ employee.NumeComplet }}">{{employee.NumeComplet}}</option>
                                {% endif %}
                                {% endfor %}
                                </select>
                           </td>
                        </tr> 
                        <tr>
                            <td style="text-align: left;vertical-align: middle; padding-left: 15px;">Scenografie</td>
                            <td><select class="form-control" name="scenographer_name">
                                {% for employee in employees  %}
                                {% if employee.Functie == "Scenograf" %}
                                <option value="{{ employee.NumeComplet }}">{{employee.NumeComplet}}</option>
                                {% endif %}
                                {% endfor %}
                                </select>
                           </td>
                        </tr> 
                        <tr>
                            <td style="text-align: left;vertical-align: middle; padding-left: 15px;">Productie</td>
                            <td><select class="form-control" name="producer_name">
                                {% for employee in employees  %}
                                {% if employee.Functie == "Producator" %}
                                <option value="{{ employee.NumeComplet }}">{{employee.NumeComplet}}</option>
                                {% endif %}
                                {% endfor %}
                                </select>
                           </td>
                        </tr> 
                        <tr>
                            <td style="text-align: left;vertical-align: middle; padding-left: 15px;">Sunet</td>
                            <td><select class="form-control" name="sound_name">
                                {% for employee in employees  %}
                                {% if employee.Functie == "Operator sunet" %}
                                <option value="{{ employee.NumeComplet }}">{{employee.NumeComplet}}</option>
                                {% endif %}
                                {% endfor %}
                                </select>
                           </td>
                        </tr> 

                        <tr>
                            <td style="text-align: left;vertical-align: middle; padding-left: 15px;">Lumini</td>
                            <td><select class="form-control" name="lights_name">
                                {% for employee in employees  %}
                                {% if employee.Functie == "Operator lumini" %}
                                <option value="{{ employee.NumeComplet }}">{{employee.NumeComplet}}</option>
                                {% endif %}
                                {% endfor %}
                                </select>
                           </td>
                        </tr> 
                        <tr>
                            <td style="text-align: left;vertical-align: middle; padding-left: 15px;">Costume</td>
                            <td><select class="form-control" name="costume_name">
                                {% for employee in employees  %}
                                {% if employee.Functie == "Costumier" %}
                                <option value="{{ employee.NumeComplet }}">{{employee.NumeComplet}}</option>
                                {% endif %}
                                {% endfor %}
                                </select>
                           </td>
                        </tr> 
                        <tr>
                            <td colspan="2"><button class="btn btn-primary" type="submit">Save</button></td>
                        </tr>
                    </table>
                </form>
                {% comment "" %}
                <ul style="text-align: left;vertical-align: middle;padding-left: 15px;">
                    <li><small>Readers should not register multiple times</small></li>
                    <li><small>Duplicate reader registrations will be deactivated</small></li>
                    <li><small>Contact information provided above must be correct and subject to verification</small></li>
                </ul>
                {% endcomment %}
            </div>
        </div>
        <div class="col-md-8">
            <div class="row">
                <nav class="navbar bg-body-light">
                    <div class="container-fluid justify-content-center align-items-center">
                        <form class="d-flex" role="search" action="/adauga-actori/search" method="POST">
                            {% csrf_token %}
                            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search" name="search_name">
                            <button class="btn btn-outline-primary" type="submit">Salveaza</button>
                          </form>
                    </div>
                </nav>
            </div>
            <div class="row" style="margin-top: 20px;">
                <p>{{actors|length}} spectacole in baza de date.</p>
            </div>
            <div class="row" style="margin-top: 20px;">
                <div class="container" style="overflow-y: auto;height: 400px;">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <td>Nume</td>
                                <td>Autor</td>
                                <td>Gen</td>
                                <td>Regizor</td>
                                <td>Scenograf</td>
                                <td>Producator</td>
                                <td>Sunet</td>
                                <td>Lumini</td>
                                <td>Costume</td>
                                <td>Modificati sau stergeti</td>
                            </tr>
                        </thead>
                        <tbody>
                            {% for show in shows  %}
                                <tr>
                                    <td>{{show.Nume}}</td>
                                    <td>{{show.Autor}}</td>
                                    <td>{{show.Gen}}</td>
                                    <td>{{show.Regizor}}</td>
                                    <td>{{show.Scenograf}}</td>
                                    <td>{{show.Producator}}</td>
                                    <td>{{show.Sunet}}</td>
                                    <td>{{show.Lumini}}</td>
                                    <td>{{show.Costume}}</td>
                                    <td><button type="button" class="btn btn-primary actor-modal-button" data-toggle="modal" data-target="#updateActorsModal" data-actor-id="{{ actor.ID }}" data-actor-nume="{{ actor.Nume }}" data-actor-prenume="{{ actor.Prenume }}" data-actor-cnp="{{ actor.CNP }}" data-actor-telefon="{{ actor.Telefon }}" data-actor-email="{{ actor.Email }}" data-actor-studii="{{ actor.Studii }}">Modificati sau stergeti</button></td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="updateActorsModal" tabindex="-1" role="dialog" aria-labelledby="updateActorsLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="updateActorsLabel">Modificati sau stergeti</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
            <form id="actor-form" action="/adauga-actori/update" method="POST">
                {% csrf_token %}
                <input type="hidden" class="form-control" id="actor-id" name="actor_id">
                <div class="form-group">
                    <label for="recipient-name" class="col-form-label">Nume:</label>
                    <input type="text" class="form-control" id="recipient-name" name="actor_name">
                </div>
                <div class="form-group">
                    <label for="recipient-firstname" class="col-form-label">Prenume:</label>
                    <input type="text" class="form-control" id="recipient-firstname" name="actor_firstname">
                </div>
                <div class="form-group">
                    <label for="recipient-CNP" class="col-form-label">CNP:</label>
                    <input type="text" class="form-control" id="recipient-CNP" name="actor_CNP">
                </div>
                <div class="form-group">
                    <label for="recipient-phone" class="col-form-label">Telefon:</label>
                    <input type="text" class="form-control" id="recipient-phone" name="actor_phone">
                </div>
                <div class="form-group">
                    <label for="recipient-email" class="col-form-label">E-mail:</label>
                    <input type="text" class="form-control" id="recipient-email" name="actor_email">
                </div>
                <div class="form-group">
                    <label for="recipient-education" class="col-form-label">Studii:</label>
                    <input type="text" class="form-control" id="recipient-education" name="actor_education">
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" type="submit" data-action="/adauga-actori/update">Adauga modificari</button>
                    <button class="btn btn-secondary" type="submit" data-action="/adauga-actori/delete">Sterge</button>
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Close</button>

                </div>
            </form>

            <form id="actor-form-delete" action="/adauga-actori/delete" method="POST">
                {% csrf_token %}
                <input type="hidden" class="form-control" id="actor-id-delete" name="actor_id">
            </form>
            
        </div>
      </div>
    </div>
  </div>

  <script>
    $(document).ready(function () {
        var refferingPage;
        $('.actor-modal-button').on('click', function () {
            refferingPage = window.location.href;
            var actorId = $(this).data('actor-id');
            var actorNume = $(this).data('actor-nume');
            var actorPrenume = $(this).data('actor-prenume');
            var actorCNP = $(this).data('actor-cnp');
            var actorTelefon = $(this).data('actor-telefon');
            var actorEmail = $(this).data('actor-email');
            var actorStudii = $(this).data('actor-studii');
            // Add similar lines for other actor attributes

            // Populate the form fields with actor data
            $('#actor-id').val(actorId);
            $('#recipient-name').val(actorNume);
            $('#recipient-firstname').val(actorPrenume);
            $('#recipient-CNP').val(actorCNP);
            $('#recipient-phone').val(actorTelefon);
            $('#recipient-email').val(actorEmail);
            $('#recipient-education').val(actorStudii);
            // Add similar lines for other modal fields


            // Show the modal
        $('#updateActorsModal').modal('show');
        });

        $('#updateActorsModal').on('hidden.bs.modal', function () {
            // Navigate back to the previous page when the modal is closed
            history.replaceState(null, null, referringPage);
        });
            
        $('#updateActorsModal').on('submit', '#actor-form', function () {
            // Submit the form to the appropriate URL based on the button clicked
            var action = $(this).find('button:focus').data('action');
            $(this).attr('action', action);
        });
    });
</script>

{% endblock main_content %}



